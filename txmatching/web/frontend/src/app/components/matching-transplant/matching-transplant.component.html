<div *ngIf="transplant && donor && recipient" class="transplant">
  <div class="transplant-header">
    <div class="pair">
      <flag [countryCode]="donor.parameters.country_code"></flag>
      {{ donor.medical_id }}
      <fa-icon [icon]="arrowRight"></fa-icon>
      {{ recipient.medical_id }}
      <flag [countryCode]="recipient.parameters.country_code"></flag>
    </div>

    <div class="score">
      Score: <span>{{ transplant.score }}</span>
    </div>
  </div>

  <div class="transplant-content">
    <table>
      <tbody>
      <tr>
        <td></td>
        <td>
          <flag [countryCode]="donor.parameters.country_code"></flag>
          {{ donor.medical_id }}
        </td>
        <td colspan="2">
          <flag [countryCode]="recipient.parameters.country_code"></flag>
          {{ recipient.medical_id }}
        </td>
        <td>Score</td>
      </tr>
      <tr>
        <td>Blood type</td>
        <td>
          <app-code [class.matching]="isDonorBloodCompatible">{{ donor.parameters.blood_group }}</app-code>
        </td>
        <td colspan="2">
          <app-code [class.matching]="isDonorBloodCompatible">{{ recipient.parameters.blood_group }}</app-code>
          <div class="small">
            Acceptable:
            <app-code *ngFor="let bloodGroup of recipient.acceptable_blood_groups">{{ bloodGroup }}</app-code>
          </div>
        </td>
        <td>-</td>
      </tr>
      <tr class="anti-header">
        <td></td>
        <td>Antigens</td>
        <td>Antigens</td>
        <td>Antibodies</td>
        <td></td>
      </tr>
      <tr *ngFor="let prefix of prefixes">
        <td>{{prefix}}</td>
        <td>
          <app-code *ngFor="let code of filterCodes(donor.parameters.hla_typing.codes, prefix)"
                    [class]="getDonorAntigenClass(code)">{{ code }}</app-code>
        </td>
        <td>
          <app-code *ngFor="let code of filterCodes(recipient.parameters.hla_typing.codes, prefix)"
                    [class]="getRecipientAntigenClass(code)">{{ code }}</app-code>
        </td>
        <td>
          <app-code *ngFor="let code of filterCodes(recipient.hla_antibodies.hla_codes_over_cutoff, prefix)"
                    [class]="getRecipientAntibodyClass(code)">{{ code }}</app-code>
        </td>
        <td>{{ antigenScore(prefix) }}</td>
      </tr>
      <tr>
        <td>Other</td>
        <td>
          <app-code *ngFor="let code of otherHLA(donor.parameters.hla_typing.codes)"
                    [class]="getDonorAntigenClass(code)">{{ code }}</app-code>
        </td>
        <td>
          <app-code *ngFor="let code of otherHLA(recipient.parameters.hla_typing.codes)"
                    [class]="getRecipientAntigenClass(code)">{{ code }}</app-code>
        </td>
        <td>
          <app-code *ngFor="let code of otherHLA(recipient.hla_antibodies.hla_codes_over_cutoff)"
                    [class]="getRecipientAntibodyClass(code)">{{ code }}</app-code>
        </td>
        <td>-</td>
      </tr>
      <tr class="footer-score">
        <td colspan="4">
          Final score:
        </td>
        <td><span>{{ transplant.score }}</span></td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
