<div class="transplant">
  <div class="transplant-header" [class.compatible]="isBloodCompatible">
    <app-patient-pair [donor]="donor" [recipient]="recipient"></app-patient-pair>

    <app-score-indicator [configuration]="configuration"
                         [score]="score"
                         [showScore]="true"></app-score-indicator>
  </div>

  <div class="transplant-content">
    <table *ngIf="donor && recipient && detailedScorePerGroup">
      <tbody>
      <tr>
        <td></td>
        <td>
          Donor
          <div class="center-holder">
            <patient [patient]="donor"></patient>
          </div>
        </td>
        <td colspan="2">
          Recipient
          <div class="center-holder">
            <patient [patient]="recipient"></patient>
          </div>
        </td>
        <td></td>
      </tr>
      <tr>
        <td>Blood type</td>
        <td>
          <app-code [class.matching]="isBloodCompatible">{{ donor.parameters.blood_group }}</app-code>
        </td>
        <td colspan="2">
          <app-code [class.matching]="isBloodCompatible">{{ recipient.parameters.blood_group }}</app-code>
          <div class="small">
            Acceptable:
            <app-code *ngFor="let bloodGroup of recipient.acceptable_blood_groups">{{ bloodGroup }}</app-code>
          </div>
        </td>
        <td></td>
      </tr>
      <tr class="anti-header">
        <td></td>
        <td>Antigens</td>
        <td>Antigens</td>
        <td>Antibodies</td>
        <td></td>
      </tr>
      <tr *ngFor="let compatibilityIndex of detailedScorePerGroup">
        <td>{{ compatibilityIndex.hla_group }}</td>
        <td>
          <app-code *ngFor="let match of compatibilityIndex.donor_matches"
                    [class]="getHlaClass(match.match_type)">{{ match.hla_code }}</app-code>
        </td>
        <td>
          <app-code *ngFor="let match of compatibilityIndex.recipient_matches"
                    [class]="getHlaClass(match.match_type)">{{ match.hla_code }}</app-code>
        </td>
        <td>
          <app-code *ngFor="let match of compatibilityIndex.antibody_matches"
                    [class]="getHlaClass(match.match_type)">{{ match.hla_code }}</app-code>
        </td>
        <td>{{ compatibilityIndex.group_compatibility_index }}</td>
      </tr>
      <!-- More info -->
      <tr class="anti-header" *ngIf="showPacientDetail">
        <td></td>
        <td>Donor</td>
        <td colspan="2">Recipient</td>
        <td></td>
      </tr>
      <tr *ngIf="showPacientDetail">
        <td>More info</td>
        <td>
          <small>
            <div *ngIf="donor.parameters.sex">
              Sex: <strong>{{getSexName(donor.parameters.sex)}}</strong>
            </div>
            <div *ngIf="donor.parameters.height">
              Height: <strong>{{donor.parameters.height}} cm</strong>
            </div>
            <div *ngIf="donor.parameters.weight">
              Weight: <strong>{{donor.parameters.weight}} kg</strong>
            </div>
            <div *ngIf="donor.parameters.year_of_birth">
              Born: <strong>{{donor.parameters.year_of_birth}}</strong>
              ({{getPacientAge(donor.parameters.year_of_birth)}} years old)
            </div>
          </small>
        </td>
        <td colspan="2">
          <small>
            <div *ngIf="recipient.parameters.sex">
              Sex: <strong>{{getSexName(recipient.parameters.sex)}}</strong>
            </div>
            <div *ngIf="recipient.parameters.height">
              Height: <strong>{{recipient.parameters.height}} cm</strong>
            </div>
            <div *ngIf="recipient.parameters.weight">
              Weight: <strong>{{recipient.parameters.weight}} kg</strong>
            </div>
            <div *ngIf="recipient.parameters.year_of_birth">
              Born: <strong>{{recipient.parameters.year_of_birth}}</strong>
              ({{getPacientAge(recipient.parameters.year_of_birth)}} years old)
            </div>
          </small>
        </td>
        <td></td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
